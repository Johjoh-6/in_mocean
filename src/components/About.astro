---
import { getCollection } from "astro:content";
import { t, type Locale } from "../translations";
import CardStats from "./CardStats.astro";

import { getIcon } from "../utils/icons";

interface Props {
	locale: Locale;
}

const { locale } = Astro.props;

const allEvents = await getCollection("events");
const uniqueCities = new Set(allEvents.map(({ data }) => data.city));
const uniqueLocations = new Set(allEvents.map(({ data }) => data.location));

// put a real image
const djImage = {
	src: "https://images.unsplash.com/photo-1600542552868-56ed242290e7?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHxESiUyMHR1cm50YWJsZXMlMjBuaWdodHxlbnwxfHx8fDE3NzAwNDA3Mzl8MA&ixlib=rb-4.0&q=80&w=1080",
	alt: "in_mâ€™Ocean performing with turntables at night",
	blurDataURL:
		"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAAIAAoDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAv/xAAhEAACAQMDBQAAAAAAAAAAAAABAgMABAUGIWGBkaGx0f/EABUBAQEAAAAAAAAAAAAAAAAAAAMF/8QAGhEAAgIDAAAAAAAAAAAAAAAAAAECEgMRkf/aAAwDAQACEQMRAD8AltJagyeH0AthI5xdrLcNM91BF5pX2HaH9bcfaSXWGaRmknyJckliyjqTzSlT54b6bk+h0R//2Q==",
};
---

<section
	id="about"
	class="relative py-20 bg-slate-950"
	aria-labelledby="about-title"
>
	<!-- Background Pattern -->
	<div class="absolute inset-0 opacity-5">
		<div
			class="absolute inset-0"
			style="background-image: radial-gradient(circle at 25% 25%, #f97316 1px, transparent 1px), radial-gradient(circle at 75% 75%, #ec4899 1px, transparent 1px); background-size: 50px 50px;"
		>
		</div>
	</div>

	<div class="container mx-auto px-4 lg:px-8 relative z-10">
		<div class="max-w-7xl mx-auto">
			<div class="grid lg:grid-cols-2 gap-16 xl:gap-24 items-center">
				<!-- DJ Image Section -->
				<div class="relative order-2 lg:order-1">
					<div class="relative w-full aspect-square max-w-lg mx-auto">
						<!-- Animated Rings -->
						<div
							class="absolute inset-0 border-4 border-orange-500/30 rounded-full ring-pulse ring-1"
						>
						</div>
						<div
							class="absolute inset-4 border-4 border-pink-500/30 rounded-full ring-pulse ring-2"
						>
						</div>

						<!-- Main Image Container -->
						<div
							class="absolute inset-12 rounded-full overflow-hidden border-4 border-white/10 shadow-2xl"
						>
							<img
								src={djImage.src}
								alt={djImage.alt}
								class="w-full h-full object-cover transform hover:scale-105 transition-transform duration-500"
								loading="lazy"
								decoding="async"
								style={`background-image: url(${djImage.blurDataURL}); background-size: cover;`}
							/>
							<div
								class="absolute inset-0 bg-linear-to-t from-orange-900/60 via-transparent to-purple-900/20"
							>
							</div>

							<!-- Floating Elements -->
							<div
								class="absolute top-4 right-4 w-3 h-3 bg-orange-400 rounded-full animate-pulse"
							>
							</div>
							<div
								class="absolute bottom-8 left-4 w-2 h-2 bg-pink-400 rounded-full animate-pulse animation-delay-300"
							>
							</div>
						</div>

						<!-- Role Badge -->
						<div
							class="absolute -bottom-4 left-1/2 -translate-x-1/2 bg-linear-to-r from-orange-500 via-pink-500 to-purple-500 text-white px-6 py-3 rounded-full text-sm font-bold shadow-2xl border border-white/10 backdrop-blur-sm"
						>
							<span
								class="flex items-center gap-2"
								role="img"
								aria-label="DJ headphones"
							>
								ðŸŽ§ {t(locale, "about.role")}
							</span>
						</div>
					</div>
				</div>

				<!-- Content Section -->
				<div class="space-y-8 order-1 lg:order-2">
					<header>
						<h2
							id="about-title"
							class="text-4xl md:text-5xl lg:text-6xl mb-6 bg-linear-to-r from-orange-400 via-pink-400 to-purple-400 bg-clip-text text-transparent font-bold leading-tight"
						>
							{t(locale, "about.title")}
						</h2>
					</header>

					<div class="space-y-6">
						<p
							class="text-lg md:text-xl text-gray-300 leading-relaxed"
						>
							{t(locale, "about.description")}
						</p>

						<p
							class="text-lg md:text-xl text-gray-400 leading-relaxed"
						>
							{t(locale, "about.mission")}
						</p>
					</div>

					<!-- Stats Grid -->
					<div
						class="grid grid-cols-2 gap-4 md:gap-6 pt-8"
						role="list"
						aria-label="DJ Statistics"
					>
						<div role="listitem">
							<CardStats
								icon={getIcon("music-2")}
								value={String(allEvents.length)}
								label={t(locale, "about.stats.shows")}
							/>
						</div>
						<div role="listitem">
							<CardStats
								icon={getIcon("headphone")}
								value={"1k+"}
								label={t(locale, "about.stats.followers")}
							/>
						</div>
						<div role="listitem">
							<CardStats
								icon={getIcon("radio")}
								value={String(uniqueCities.size)}
								label={t(locale, "about.stats.cities")}
							/>
						</div>
						<div role="listitem">
							<CardStats
								icon={getIcon("waves")}
								value={String(uniqueLocations.size)}
								label={t(locale, "about.stats.locations")}
							/>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<style>
		.ring-pulse {
			animation: ringPulse 3s ease-in-out infinite;
		}

		.ring-1 {
			animation-delay: 0s;
		}

		.ring-2 {
			animation-delay: 1s;
		}

		.ring-3 {
			animation-delay: 2s;
		}

		.animation-delay-300 {
			animation-delay: 300ms;
		}

		@keyframes ringPulse {
			0%,
			100% {
				transform: scale(1);
				opacity: 0.7;
			}
			50% {
				transform: scale(1.02);
				opacity: 0.3;
			}
		}

		/* Responsive improvements */
		/*@media (max-width: 1023px) {
			.ring-pulse {
				animation: none;
			}
		}*/
	</style>
</section>
